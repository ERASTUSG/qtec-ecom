/*!
 * Nestable jQuery Plugin - Copyright (c) 2014 Ramon Smit - https://github.com/RamonSmit/Nestable
 */(function(a,g,u,N){var y="ontouchstart"in u,b=function(){var e=u.createElement("div"),t=u.documentElement;if(!("pointerEvents"in e.style))return!1;e.style.pointerEvents="auto",e.style.pointerEvents="x",t.appendChild(e);var l=g.getComputedStyle&&g.getComputedStyle(e,"").pointerEvents==="auto";return t.removeChild(e),!!l}(),x={contentCallback:function(e){return e.content?e.content:e.id},listNodeName:"ol",itemNodeName:"li",handleNodeName:"div",contentNodeName:"span",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",contentClass:"dd-content",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",noChildrenClass:"dd-nochildren",emptyClass:"dd-empty",expandBtnHTML:'<button class="dd-expand" data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button class="dd-collapse" data-action="collapse" type="button">Collapse</button>',group:0,maxDepth:5,threshold:20,fixedDepth:!1,fixed:!1,includeContent:!1,scroll:!1,scrollSensitivity:1,scrollSpeed:5,scrollTriggers:{top:40,left:40,right:-40,bottom:-40},effect:{animation:"none",time:"slow"},callback:function(e,t,l){},onDragStart:function(e,t,l){},beforeDragStop:function(e,t,l){},listRenderer:function(e,t){var l="<"+t.listNodeName+' class="'+t.listClass+'">';return l+=e,l+="</"+t.listNodeName+">",l},itemRenderer:function(e,t,l,n,r){var o=a.map(e,function(i,d){return" "+d+'="'+i+'"'}).join(" "),s="<"+n.itemNodeName+o+">";return s+="<"+n.handleNodeName+' class="'+n.handleClass+'">',s+="<"+n.contentNodeName+' class="'+n.contentClass+'">',s+=t,s+="</"+n.contentNodeName+">",s+="</"+n.handleNodeName+">",s+=l,s+="</"+n.itemNodeName+">",s}};function X(e,t){this.w=a(u),this.el=a(e),t=t||x,t.rootClass!==N&&t.rootClass!=="dd"&&(t.listClass=t.listClass?t.listClass:t.rootClass+"-list",t.itemClass=t.itemClass?t.itemClass:t.rootClass+"-item",t.dragClass=t.dragClass?t.dragClass:t.rootClass+"-dragel",t.handleClass=t.handleClass?t.handleClass:t.rootClass+"-handle",t.collapsedClass=t.collapsedClass?t.collapsedClass:t.rootClass+"-collapsed",t.placeClass=t.placeClass?t.placeClass:t.rootClass+"-placeholder",t.noDragClass=t.noDragClass?t.noDragClass:t.rootClass+"-nodrag",t.noChildrenClass=t.noChildrenClass?t.noChildrenClass:t.rootClass+"-nochildren",t.emptyClass=t.emptyClass?t.emptyClass:t.rootClass+"-empty"),this.options=a.extend({},x,t),this.options.json!==N&&this._build(),this.init()}X.prototype={init:function(){var e=this;e.reset(),e.el.data("nestable-group",this.options.group),e.placeEl=a('<div class="'+e.options.placeClass+'"/>');var t=this.el.find(e.options.itemNodeName);a.each(t,function(s,i){var d=a(i),h=d.parent();e.setParent(d),h.hasClass(e.options.collapsedClass)&&e.collapseItem(h.parent())}),t.length||this.appendEmptyElement(this.el),e.el.on("click","button",function(s){if(!e.dragEl){var i=a(s.currentTarget),d=i.data("action"),h=i.parents(e.options.itemNodeName).eq(0);d==="collapse"&&e.collapseItem(h),d==="expand"&&e.expandItem(h)}});var l=function(s){var i=a(s.target);if(!i.hasClass(e.options.handleClass)){if(i.closest("."+e.options.noDragClass).length)return;i=i.closest("."+e.options.handleClass)}!i.length||e.dragEl||(e.isTouch=/^touch/.test(s.type),!(e.isTouch&&s.touches.length!==1)&&(s.preventDefault(),e.dragStart(s.touches?s.touches[0]:s)))},n=function(s){e.dragEl&&(s.preventDefault(),e.dragMove(s.touches?s.touches[0]:s))},r=function(s){e.dragEl&&(s.preventDefault(),e.dragStop(s.touches?s.changedTouches[0]:s))};y&&(e.el[0].addEventListener("touchstart",l,!1),g.addEventListener("touchmove",n,!1),g.addEventListener("touchend",r,!1),g.addEventListener("touchcancel",r,!1)),e.el.on("mousedown",l),e.w.on("mousemove",n),e.w.on("mouseup",r);var o=function(){y&&(e.el[0].removeEventListener("touchstart",l,!1),g.removeEventListener("touchmove",n,!1),g.removeEventListener("touchend",r,!1),g.removeEventListener("touchcancel",r,!1)),e.el.off("mousedown",l),e.w.off("mousemove",n),e.w.off("mouseup",r),e.el.off("click"),e.el.unbind("destroy-nestable"),e.el.data("nestable",null)};e.el.bind("destroy-nestable",o)},destroy:function(){this.el.trigger("destroy-nestable")},add:function(e){var t="."+this.options.listClass,l=a(this.el).children(t);e.parent_id!==N&&(l=l.find('[data-id="'+e.parent_id+'"]'),delete e.parent_id,l.children(t).length===0&&(l=l.append(this.options.listRenderer("",this.options))),l=l.find(t+":first"),this.setParent(l.parent())),l.append(this._buildItem(e,this.options))},replace:function(e){var t=this._buildItem(e,this.options);this._getItemById(e.id).replaceWith(t)},removeItem:function(e){var t=this.options,l=this.el;e=e||this,e.remove();var n="."+t.listClass+" ."+t.listClass+":not(:has(*))";a(l).find(n).remove();var r='[data-action="expand"], [data-action="collapse"]';a(l).find(r).each(function(){var o=a(this).siblings("."+t.listClass);o.length===0&&a(this).remove()})},remove:function(e,t){var l=this.options,n=this,r=this._getItemById(e),o=l.effect.animation||"fade",s=l.effect.time||"slow";o==="fade"?r.fadeOut(s,function(){n.removeItem(r)}):this.removeItem(r),t&&t()},removeAll:function(e){var t=this,l=this.options,n=t.el.find(l.listNodeName).first(),r=n.children(l.itemNodeName),o=l.effect.animation||"fade",s=l.effect.time||"slow";function i(){r.each(function(){t.removeItem(a(this))}),n.show(),e&&e()}o==="fade"?n.fadeOut(s,i):i()},_getItemById:function(e){return a(this.el).children("."+this.options.listClass).find('[data-id="'+e+'"]')},_build:function(){var e=this.options.json;typeof e=="string"&&(e=JSON.parse(e)),a(this.el).html(this._buildList(e,this.options))},_buildList:function(e,t){if(!e)return"";var l="",n=this;return a.each(e,function(r,o){l+=n._buildItem(o,t)}),t.listRenderer(l,t)},_buildItem:function(e,t){function l(c){var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return c+"".replace(/[&<>"']/g,function(f){return p[f]})}function n(c){var p={};for(var f in c)p[c[f]]=c[f];return p}function r(c,p){var f=c.classes||{};typeof f=="string"&&(f=[f]);var m=n(f);return m[p.itemClass]=p.itemClass,a.map(m,function(v){return v}).join(" ")}function o(c){c=a.extend({},c),delete c.children,delete c.classes,delete c.content;var p={};return a.each(c,function(f,m){typeof m=="object"&&(m=JSON.stringify(m)),p["data-"+f]=l(m)}),p}var s=o(e);s.class=r(e,t);var i=t.contentCallback(e),d=this._buildList(e.children,t),h=a(t.itemRenderer(s,i,d,t,e));return this.setParent(h),h[0].outerHTML},serialize:function(){var e,t=this,l=function(n){var r=[],o=n.children(t.options.itemNodeName);return o.each(function(){var s=a(this),i=a.extend({},s.data()),d=s.children(t.options.listNodeName);if(t.options.includeContent){var h=s.find("."+t.options.contentClass).html();h&&(i.content=h)}d.length&&(i.children=l(d)),r.push(i)}),r};return e=l(t.el.find(t.options.listNodeName).first()),e},asNestedSet:function(){var e=this,t=e.options,l=-1,n=[],r=1,o=e.el.find(t.listNodeName).first().children(t.itemNodeName);return o.each(function(){r=s(this,l+1,r)}),n=n.sort(function(d,h){return d.lft-h.lft}),n;function s(d,h,c){var p=c+1,f,m;return a(d).children(t.listNodeName).children(t.itemNodeName).length>0&&(h++,a(d).children(t.listNodeName).children(t.itemNodeName).each(function(){p=s(a(this),h,p)}),h--),f=a(d).attr("data-id"),i(f)&&(f=parseInt(f)),m=a(d).parent(t.listNodeName).parent(t.itemNodeName).attr("data-id")||"",i(m)&&(f=parseInt(m)),f&&n.push({id:f,parent_id:m,depth:h,lft:c,rgt:p}),c=p+1,c}function i(d){return a.isNumeric(d)&&Math.floor(d)==d}},returnOptions:function(){return this.options},serialise:function(){return this.serialize()},toHierarchy:function(e){var t=a.extend({},this.options,e),l=[];return a(this.element).children(t.items).each(function(){var r=n(this);l.push(r)}),l;function n(r){var o=(a(r).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);if(o){var s={id:o[2]};return a(r).children(t.listType).children(t.items).length>0&&(s.children=[],a(r).children(t.listType).children(t.items).each(function(){var i=n(this);s.children.push(i)})),s}}},toArray:function(){var e=a.extend({},this.options,this),t=e.startDepthCount||0,l=[],n=2,r=this,o=r.el.find(r.options.listNodeName).first(),s=o.children(r.options.itemNodeName);return s.each(function(){n=i(a(this),t+1,n)}),l=l.sort(function(d,h){return d.left-h.left}),l;function i(d,h,c){var p=c+1,f,m;if(d.children(e.options.listNodeName).children(e.options.itemNodeName).length>0&&(h++,d.children(e.options.listNodeName).children(e.options.itemNodeName).each(function(){p=i(a(this),h,p)}),h--),f=d.data().id,h===t+1)m=e.rootID;else{var v=d.parent(e.options.listNodeName).parent(e.options.itemNodeName).data();m=v.id}return f&&l.push({id:f,parent_id:m,depth:h,left:c,right:p}),c=p+1,c}},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.isTouch=!1,this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null},expandItem:function(e){e.removeClass(this.options.collapsedClass)},collapseItem:function(e){var t=e.children(this.options.listNodeName);t.length&&e.addClass(this.options.collapsedClass)},expandAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.expandItem(a(this))})},collapseAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.collapseItem(a(this))})},setParent:function(e){e.is(this.options.itemNodeName)&&e.children(this.options.listNodeName).length&&(e.children("[data-action]").remove(),e.prepend(a(this.options.expandBtnHTML)),e.prepend(a(this.options.collapseBtnHTML)))},unsetParent:function(e){e.removeClass(this.options.collapsedClass),e.children("[data-action]").remove(),e.children(this.options.listNodeName).remove()},dragStart:function(e){var t=this.mouse,l=a(e.target),n=l.closest(this.options.itemNodeName),r={top:e.pageY,left:e.pageX},o=this.options.onDragStart.call(this,this.el,n,r);if(!(typeof o<"u"&&o===!1)){this.placeEl.css("height",n.height()),t.offsetX=e.pageX-n.offset().left,t.offsetY=e.pageY-n.offset().top,t.startX=t.lastX=e.pageX,t.startY=t.lastY=e.pageY,this.dragRootEl=this.el,this.dragEl=a(u.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",n.outerWidth()),this.setIndexOfItem(n),n.after(this.placeEl),n[0].parentNode.removeChild(n[0]),n.appendTo(this.dragEl),a(u.body).append(this.dragEl),this.dragEl.css({left:e.pageX-t.offsetX,top:e.pageY-t.offsetY});var s,i,d=this.dragEl.find(this.options.itemNodeName);for(s=0;s<d.length;s++)i=a(d[s]).parents(this.options.listNodeName).length,i>this.dragDepth&&(this.dragDepth=i)}},createSubLevel:function(e,t){var l=a("<"+this.options.listNodeName+"/>").addClass(this.options.listClass);return t&&l.append(t),e.append(l),this.setParent(e),l},setIndexOfItem:function(e,t){t=t||[],t.unshift(e.index()),a(e[0].parentNode)[0]!==this.dragRootEl[0]?this.setIndexOfItem(a(e[0].parentNode),t):this.dragEl.data("indexOfItem",t)},restoreItemAtIndex:function(e,t){var l=this.el,n=t.length-1;function r(d,h){t[n]===0?a(d).prepend(h.clone(!0)):a(d.children[t[n]-1]).after(h.clone(!0))}for(var o=0;o<t.length;o++){if(n===parseInt(o)){r(l,e);return}var s=l[0]?l[0]:l,i=s.children[t[o]];l=i||this.createSubLevel(a(s))}},dragStop:function(e){var t={top:e.pageY,left:e.pageX},l=this.dragEl.data("indexOfItem"),n=this.dragEl.children(this.options.itemNodeName).first();n[0].parentNode.removeChild(n[0]),this.dragEl.remove();var r=this.options.beforeDragStop.call(this,this.el,n,this.placeEl.parent());if(typeof r<"u"&&r===!1){var o=this.placeEl.parent();this.placeEl.remove(),o.children().length||this.unsetParent(o.parent()),this.restoreItemAtIndex(n,l),this.reset();return}this.placeEl.replaceWith(n),this.hasNewRoot?(this.options.fixed===!0?this.restoreItemAtIndex(n,l):this.el.trigger("lostItem"),this.dragRootEl.trigger("gainedItem")):this.dragRootEl.trigger("change"),this.options.callback.call(this,this.dragRootEl,n,t),this.reset()},dragMove:function(e){var t,l,n,r,o,s=this.options,i=this.mouse;this.dragEl.css({left:e.pageX-i.offsetX,top:e.pageY-i.offsetY}),i.lastX=i.nowX,i.lastY=i.nowY,i.nowX=e.pageX,i.nowY=e.pageY,i.distX=i.nowX-i.lastX,i.distY=i.nowY-i.lastY,i.lastDirX=i.dirX,i.lastDirY=i.dirY,i.dirX=i.distX===0?0:i.distX>0?1:-1,i.dirY=i.distY===0?0:i.distY>0?1:-1;var d=Math.abs(i.distX)>Math.abs(i.distY)?1:0;if(!i.moving){i.dirAx=d,i.moving=!0;return}if(s.scroll)if(typeof g.jQuery.fn.scrollParent<"u"){var h=!1,c=this.el.scrollParent()[0];c!==u&&c.tagName!=="HTML"?(s.scrollTriggers.bottom+c.offsetHeight-e.pageY<s.scrollSensitivity?c.scrollTop=h=c.scrollTop+s.scrollSpeed:e.pageY-s.scrollTriggers.top<s.scrollSensitivity&&(c.scrollTop=h=c.scrollTop-s.scrollSpeed),s.scrollTriggers.right+c.offsetWidth-e.pageX<s.scrollSensitivity?c.scrollLeft=h=c.scrollLeft+s.scrollSpeed:e.pageX-s.scrollTriggers.left<s.scrollSensitivity&&(c.scrollLeft=h=c.scrollLeft-s.scrollSpeed)):(e.pageY-a(u).scrollTop()<s.scrollSensitivity?h=a(u).scrollTop(a(u).scrollTop()-s.scrollSpeed):a(g).height()-(e.pageY-a(u).scrollTop())<s.scrollSensitivity&&(h=a(u).scrollTop(a(u).scrollTop()+s.scrollSpeed)),e.pageX-a(u).scrollLeft()<s.scrollSensitivity?h=a(u).scrollLeft(a(u).scrollLeft()-s.scrollSpeed):a(g).width()-(e.pageX-a(u).scrollLeft())<s.scrollSensitivity&&(h=a(u).scrollLeft(a(u).scrollLeft()+s.scrollSpeed)))}else console.warn("To use scrolling you need to have scrollParent() function, check documentation for more information");this.scrollTimer&&clearTimeout(this.scrollTimer),s.scroll&&h&&(this.scrollTimer=setTimeout(function(){a(g).trigger(e)},10)),i.dirAx!==d?(i.distAxX=0,i.distAxY=0):(i.distAxX+=Math.abs(i.distX),i.dirX!==0&&i.dirX!==i.lastDirX&&(i.distAxX=0),i.distAxY+=Math.abs(i.distY),i.dirY!==0&&i.dirY!==i.lastDirY&&(i.distAxY=0)),i.dirAx=d,i.dirAx&&i.distAxX>=s.threshold&&(i.distAxX=0,n=this.placeEl.prev(s.itemNodeName),i.distX>0&&n.length&&!n.hasClass(s.collapsedClass)&&!n.hasClass(s.noChildrenClass)&&(t=n.find(s.listNodeName).last(),o=this.placeEl.parents(s.listNodeName).length,o+this.dragDepth<=s.maxDepth&&(t.length?(t=n.children(s.listNodeName).last(),t.append(this.placeEl)):this.createSubLevel(n,this.placeEl))),i.distX<0&&(r=this.placeEl.next(s.itemNodeName),r.length||(l=this.placeEl.parent(),this.placeEl.closest(s.itemNodeName).after(this.placeEl),l.children().length||this.unsetParent(l.parent()))));var p=!1;if(b||(this.dragEl[0].style.visibility="hidden"),this.pointEl=a(u.elementFromPoint(e.pageX-u.body.scrollLeft,e.pageY-(g.pageYOffset||u.documentElement.scrollTop))),b||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(s.handleClass)&&(this.pointEl=this.pointEl.closest(s.itemNodeName)),this.pointEl.hasClass(s.emptyClass))p=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(s.itemClass))return;var f=this.pointEl.closest("."+s.rootClass),m=this.dragRootEl.data("nestable-id")!==f.data("nestable-id");if(!i.dirAx||m||p){if(m&&s.group!==f.data("nestable-group")||this.options.fixedDepth&&this.dragDepth+1!==this.pointEl.parents(s.listNodeName).length||(o=this.dragDepth-1+this.pointEl.parents(s.listNodeName).length,o>s.maxDepth))return;var v=e.pageY<this.pointEl.offset().top+this.pointEl.height()/2;l=this.placeEl.parent(),p?(t=a(u.createElement(s.listNodeName)).addClass(s.listClass),t.append(this.placeEl),this.pointEl.replaceWith(t)):v?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),l.children().length||this.unsetParent(l.parent()),this.dragRootEl.find(s.itemNodeName).length||this.appendEmptyElement(this.dragRootEl),this.dragRootEl=f,m&&(this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}},appendEmptyElement:function(e){e.append('<div class="'+this.options.emptyClass+'"/>')}},a.fn.nestable=function(e){var t=this,l=this,n=arguments;return"Nestable"in g||(g.Nestable={},Nestable.counter=0),t.each(function(){var r=a(this).data("nestable");if(!r)Nestable.counter++,a(this).data("nestable",new X(this,e)),a(this).data("nestable-id",Nestable.counter);else if(typeof e=="string"&&typeof r[e]=="function")if(n.length>1){for(var o=[],s=1;s<n.length;s++)o.push(n[s]);l=r[e].apply(r,o)}else l=r[e]()}),l||t}})(window.jQuery||window.Zepto,window,document);window.admin.removeSubmitButtonOffsetOn("#image");$("#type").on("change",a=>{$(".link-field").addClass("hide"),$(`.${a.currentTarget.value}-field`).removeClass("hide")});$(".dd").nestable({maxDepth:15});$(".dd").on("change",()=>{$.ajax({type:"PUT",url:route("admin.menus.items.order.update"),contentType:"application/json; charset=utf-8",data:JSON.stringify($(".dd").nestable("serialize")[0]),success(){success(trans("menu::messages.menu_items_order_updated"))},error(a){error(a.responseJSON.message)}})});let C,E=$("#confirmation-modal");$(".delete-menu-item").on("click",a=>{C=$(a.currentTarget).closest(".dd-item").data("id"),E.modal("show")});E.find("form").on("submit",a=>{a.preventDefault(),E.modal("hide"),$.ajax({type:"DELETE",url:route("admin.menus.items.destroy",C),success(){success(trans("menu::messages.menu_item_deleted")),$(`.dd-item[data-id="${C}"]`).fadeOut()},error(g){error(g.responseJSON.message)}})});
//# sourceMappingURL=main-0e4787b4-v4.0.0.js.map
